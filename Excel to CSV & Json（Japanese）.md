
### 📊 Excel (.xlsx) → CSV / JSON: 連携ガイドライン

ChatGPT と Excel データを連携させる際には、**データの整合性**と**意味構造**の両方を保つために、適切な中間フォーマットを選択することが重要です。

#### ✅ 基本ルール：

- **CSV** を使用するのは、Excel ファイルが**書式なしの純粋な表形式データ**（複数シートや結合セルを含まない）である場合です。
- **JSON** を使用するのは、Excel ファイルが**複数シート、結合セル、セル単位の書式、数式**などを含む場合です。

#### 🔄 変換シナリオ別の推奨形式：

| シナリオ | 推奨フォーマット | 理由 |
|----------|------------------|------|
| 単一シート、プレーンなデータ | `.csv` | 軽量で読みやすく、AIと相性が良い |
| 複数シートまたは構造化されたExcel | `.json` | シート名やデータ構造を保持できる |
| 書式付き（色、太字、結合セルなど） | 書式付き `.json` | 書式情報をセルごとに保持可能 |
| 人間による編集を重視 | `.xlsx` | 視覚的にわかりやすく、編集が容易 |
| ChatGPT によるロジック検証や構造確認 | `.json` | メタ情報を含めて明確に構造を表現できる |

#### 🔧 JSON の記述ヒント：

- シートと行をネスト構造で表現します：
  ```json
  {
    "Sheet1": [
      {"日付": "2025-08-08", "コード": "600000", "終値": 12.34},
      {"日付": "2025-08-07", "コード": "600000", "終値": 12.10}
    ],
    "Sheet2": [ ... ]
  }
  ```

- 書式を保持したい場合、各セルに書式情報を追加します：
  ```json
  {
    "value": "売上高",
    "font": {"bold": true, "color": "#FF0000"},
    "fill": {"bgColor": "#FFFF00"},
    "formula": "=SUM(A1:A5)"
  }
  ```

#### 📦 ファイルサイズに関する考察：

- `.xlsx` ファイルは ZIP 圧縮されており、`.json` はプレーンテキストなので、通常は **3～6倍程度大きく** なります。
- ただし ChatGPT との連携においては、このサイズ差は**実用上ほとんど問題になりません**。
- JSON は `.json.gz` として圧縮することで、転送サイズを大きく削減できます。

#### 🧠 最終アドバイス：

> データ交換や AI とのロジック検証が目的であれば、構造情報が豊富な Excel ファイルには `.json` を使用し、平坦なテーブル構造には `.csv` を使いましょう。  
> 必要に応じて JSON を圧縮し、AI とのやりとりでは**見た目より構造を優先**しましょう。
